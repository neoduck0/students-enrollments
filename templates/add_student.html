{% extends "base.html" %}

{% block title %}Add Student{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4">Add New Student</h1>
        
        <!-- Alert Display -->
        {% if alert_type and alert_message %}
        <div class="alert alert-{{ alert_type }} alert-dismissible fade show" role="alert">
            {{ alert_message }}
            {% if alert_type == "success" %}
            <script>
                setTimeout(() => {
                    const alert = document.querySelector('.alert');
                    if (alert) {
                        const bsAlert = new bootstrap.Alert(alert);
                        bsAlert.close();
                    }
                }, 5000);
            </script>
            {% endif %}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        {% endif %}
        
        <!-- Add Student Form -->
        <form method="POST" class="needs-validation" novalidate>
            <!-- Personal Information Section -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Personal Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="name" class="form-label">Full Name *</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                            <div class="invalid-feedback">
                                Please provide a valid name.
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="gender" class="form-label">Gender *</label>
                            <select class="form-select" id="gender" name="gender" required>
                                <option value="">Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="invalid-feedback">
                                Please select a gender.
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="nationality" class="form-label">Nationality *</label>
                            <input type="text" class="form-control" id="nationality" name="nationality" required>
                            <div class="invalid-feedback">
                                Please provide nationality.
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="birthday" class="form-label">Date of Birth *</label>
                            <input type="date" class="form-control" id="birthday" name="birthday" required>
                            <div class="invalid-feedback">
                                Please provide a valid date of birth.
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="ethnicity" class="form-label">Ethnicity *</label>
                            <input type="text" class="form-control" id="ethnicity" name="ethnicity" required>
                            <div class="invalid-feedback">
                                Please provide ethnicity.
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="province" class="form-label">Province/State *</label>
                            <input type="text" class="form-control" id="province" name="province" required>
                            <div class="invalid-feedback">
                                Please provide province/state.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact Information Section -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Contact Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="card_id" class="form-label">Student ID Card *</label>
                            <input type="text" class="form-control" id="card_id" name="card_id" 
                                   pattern="[A-Za-z0-9]+" required>
                            <div class="invalid-feedback">
                                Please provide a valid student ID (alphanumeric only).
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="phone" class="form-label">Phone Number *</label>
                            <input type="tel" class="form-control" id="phone" name="phone" 
                                   pattern="[0-9\-\+\s]+" required>
                            <div class="invalid-feedback">
                                Please provide a valid phone number.
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="mother_name" class="form-label">Mother's Name *</label>
                            <input type="text" class="form-control" id="mother_name" name="mother_name" required>
                            <div class="invalid-feedback">
                                Please provide mother's name.
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="father_phone" class="form-label">Father's Phone *</label>
                            <input type="tel" class="form-control" id="father_phone" name="father_phone" 
                                   pattern="[0-9\-\+\s]+" required>
                            <div class="invalid-feedback">
                                Please provide a valid father's phone number.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Academic Information Section -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Academic Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="faculty" class="form-label">Faculty *</label>
                            <input type="text" class="form-control" id="faculty" name="faculty" required>
                            <div class="invalid-feedback">
                                Please provide faculty.
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="major" class="form-label">Major *</label>
                            <input type="text" class="form-control" id="major" name="major" required>
                            <div class="invalid-feedback">
                                Please provide major.
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label for="year" class="form-label">Year *</label>
                            <input type="number" class="form-control" id="year" name="year" 
                                   min="1" max="10" required>
                            <div class="invalid-feedback">
                                Please provide a valid year (1-10).
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="study_schedule" class="form-label">Study Schedule *</label>
                            <select class="form-select" id="study_schedule" name="study_schedule" required>
                                <option value="">Select Schedule</option>
                                <option value="day">Day</option>
                                <option value="night">Night</option>
                            </select>
                            <div class="invalid-feedback">
                                Please select study schedule.
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="repeat_years" class="form-label">Repeat Years</label>
                            <input type="number" class="form-control" id="repeat_years" name="repeat_years" 
                                   min="0" max="10" value="0">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="admission_session" class="form-label">Admission Session *</label>
                            <input type="text" class="form-control" id="admission_session" name="admission_session" required>
                            <div class="invalid-feedback">
                                Please provide admission session.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- School Details Section -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">School Details</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="school_focus" class="form-label">School Focus *</label>
                            <input type="text" class="form-control" id="school_focus" name="school_focus" required>
                            <div class="invalid-feedback">
                                Please provide school focus.
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="school_grad_session" class="form-label">School Graduation Session *</label>
                            <input type="text" class="form-control" id="school_grad_session" name="school_grad_session" required>
                            <div class="invalid-feedback">
                                Please provide school graduation session.
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="school_results" class="form-label">School Results (%)</label>
                            <input type="number" class="form-control" id="school_results" name="school_results" 
                                   min="0" max="100" step="0.1" value="0.0">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Disability Information Section -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Disability Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-3">
                            <label for="is_disabled" class="form-label">Disabled?</label>
                            <select class="form-select" id="is_disabled" name="is_disabled">
                                <option value="0">No</option>
                                <option value="1">Yes</option>
                            </select>
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="disability" class="form-label">Disability Type</label>
                            <input type="text" class="form-control" id="disability" name="disability" 
                                   placeholder="If applicable">
                        </div>
                        <div class="col-md-5 mb-3">
                            <label for="disability_cause" class="form-label">Disability Cause</label>
                            <input type="text" class="form-control" id="disability_cause" name="disability_cause" 
                                   placeholder="If applicable">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="text-center">
                <button type="submit" class="btn btn-primary btn-lg">Add Student</button>
                <a href="{{ url_for('home') }}" class="btn btn-secondary btn-lg ms-2">Cancel</a>
            </div>
        </form>
    </div>
</div>

<script>
// Bootstrap form validation
(function() {
    'use strict';
    var forms = document.querySelectorAll('.needs-validation');
    Array.prototype.slice.call(forms).forEach(function(form) {
        form.addEventListener('submit', function(event) {
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            }
            form.classList.add('was-validated');
        }, false);
    });
})();
</script>

{% endblock %}
